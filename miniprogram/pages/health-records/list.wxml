<!-- 健康记录列表页 -->
<view class="container">
  <!-- 筛选区域 -->
  <view class="filter-section">
    <!-- 日期筛选和添加按钮 -->
    <view class="date-filter-container">
      <view class="date-filter">
        <picker mode="date" value="{{startDate}}" bindchange="onStartDateChange">
          <view class="date-picker">
            <text>{{startDate}}</text>
          </view>
        </picker>
        <text class="date-separator">至</text>
        <picker mode="date" value="{{endDate}}" bindchange="onEndDateChange">
          <view class="date-picker">
            <text>{{endDate}}</text>
          </view>
        </picker>
      </view>
      
      <!-- 添加按钮 -->
      <view class="add-button" bindtap="navigateToAdd">
        <text class="add-icon">+</text>
      </view>
    </view>
  </view>
  
  <!-- 记录列表 -->
  <view class="record-list">
    <block wx:if="{{records.length > 0}}">
      <view class="record-item" wx:for="{{records}}" wx:key="id" bindtap="viewRecordDetail" data-id="{{item.id}}">
        <!-- 记录图标和类型 -->
        <view class="record-type">
          <image class="record-icon" src="{{item.typeIcon}}" mode="aspectFit"></image>
        </view>
        
        <!-- 记录内容 -->
        <view class="record-content">
          <!-- 记录值和时间 -->
          <view class="record-main">
            <!-- 血压记录 -->
            <block wx:if="{{item.systolic_pressure && item.diastolic_pressure}}">
              <view class="record-value">
                <text class="value-label">血压:</text>
                <text class="value">{{item.systolic_pressure}}/{{item.diastolic_pressure}} mmHg</text>
                <text wx:if="{{item.heart_rate}}" class="value-extra">  心率: {{item.heart_rate}} bpm</text>
              </view>
            </block>
            
            <!-- 体重记录 -->
            <block wx:elif="{{item.weight}}">
              <view class="record-value">
                <text class="value-label">体重:</text>
                <text class="value">{{item.weight}} kg</text>
              </view>
            </block>
            
            <!-- 血糖记录 -->
            <block wx:elif="{{item.blood_sugar}}">
              <view class="record-value">
                <text class="value-label">血糖:</text>
                <text class="value">{{item.blood_sugar}} mmol/L</text>
              </view>
            </block>
            
            <!-- 体温记录 -->
            <block wx:elif="{{item.temperature}}">
              <view class="record-value">
                <text class="value-label">体温:</text>
                <text class="value">{{item.temperature}} ℃</text>
              </view>
            </block>
            
            <!-- 记录时间 -->
            <view class="record-time">
              <text>{{item.formattedDate}} {{item.formattedTime}}</text>
            </view>
          </view>
          
          <!-- 备注信息 -->
          <view class="record-note" wx:if="{{item.notes}}">
            <text>{{item.notes}}</text>
          </view>
        </view>
        
        <!-- 操作按钮 -->
        <view class="record-actions">
          <!-- 编辑和删除按钮 -->
          <view class="action-button edit" catchtap="onEditRecord" data-id="{{item.id}}">
            <image class="action-icon" src="/assets/icons/edit.png" mode="aspectFit"></image>
          </view>
          
          <view class="action-button delete" catchtap="onDeleteRecord" data-id="{{item.id}}">
            <text wx:if="{{loadingIds.includes(item.id)}}" class="loading">...</text>
            <image wx:else class="action-icon" src="/assets/icons/delete.png" mode="aspectFit"></image>
          </view>
        </view>
      </view>
      
      <!-- 加载更多 -->
      <view class="load-more" wx:if="{{hasMore && !loading}}" bindtap="loadMoreRecords">
        <text>加载更多</text>
      </view>
      
      <!-- 加载中 -->
      <view class="loading-indicator" wx:if="{{loading}}">
        <text>加载中...</text>
      </view>
      
      <!-- 没有更多数据 -->
      <view class="no-more" wx:if="{{!hasMore && records.length > 0 && !loading}}">
        <text>没有更多数据</text>
      </view>
    </block>
    
    <!-- 暂无数据 -->
    <view class="empty-state" wx:if="{{!loading && records.length === 0}}">
      <image class="empty-icon" src="/assets/icons/empty.png" mode="aspectFit"></image>
      <text class="empty-text">暂无健康记录</text>
      <view class="empty-action" bindtap="navigateToAdd">
        <text>添加记录</text>
      </view>
    </view>
  </view>
</view> 